---
sidebar_position: 100
---

# Metafields Reference and liquid

Collection Tree builds and maintains a set of **metafields** that describe your collection hierarchy: parent/child relationships, depth levels, root collections, and breadcrumb priorities. These metafields are kept in sync automatically whenever you update your tree in the app.

## When to use metafields

For most stores, the **built-in app blocks** (Collection Grid, Breadcrumbs, etc.) are the easiest way to display your hierarchy — no code required.

Metafields are the better choice when you:

- Have a development team that needs to integrate the hierarchy into a **custom theme** with specific styling or layout requirements.
- Need hierarchy data in contexts the app blocks don't cover — for example, Liquid email templates, third-party page builders, or headless storefronts via the Storefront API.
- Want to build custom navigation, mega-menus, or any other feature that relies on the parent/child structure.

> **Tip:** Metafields are not limited to Liquid templates. Because they are standard Shopify metafields, they are also available through the Storefront API and the Admin API, which makes them useful for headless builds, custom apps, or any workflow that reads metafield data.

---

## Metafield reference

All metafields use the namespace `app--162129281025`.

### Collection metafields

These are set on each **collection** resource.

| Metafield key          | Type                        | Description                                                                                                                                                                         |
| ---------------------- | --------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| `parent_collection`    | `collection_reference`      | The direct parent of this collection. Blank for root collections.                                                                                                                   |
| `children_collections` | `list.collection_reference` | Ordered list of direct child collections.                                                                                                                                           |
| `depth`                | `number_integer`            | How deep the collection sits in the tree. Root collections have a depth of **1**, their children **2**, and so on.                                                                  |
| `breadcrumb_priority`  | `number_integer`            | Priority value configured in the app's Breadcrumbs settings. Lower numbers = higher priority. Used to pick the best breadcrumb path when a product belongs to multiple collections. |

### Shop metafields

These are set on the **shop** resource and give access to root-level collections.

| Metafield key        | Type                        | Description                                  |
| -------------------- | --------------------------- | -------------------------------------------- |
| `root_collections_1` | `list.collection_reference` | First batch of root collections (up to 250). |
| `root_collections_2` | `list.collection_reference` | Second batch (items 251–500).                |
| `root_collections_3` | `list.collection_reference` | Third batch (items 501–750).                 |
| `root_collections_4` | `list.collection_reference` | Fourth batch (items 751–1000).               |

Root collections are split across multiple metafields because Shopify limits list metafields to 250 items. Most stores only need `root_collections_1`.

---

## Accessing metafields in Liquid

In Liquid, the namespace uses the dot notation `app--162129281025`:

```liquid
{{ collection.metafields['app--162129281025'].depth }}
{{ collection.metafields['app--162129281025'].parent_collection.value }}
{{ collection.metafields['app--162129281025'].children_collections.value }}
```

For shop-level metafields:

```liquid
{{ shop.metafields['app--162129281025'].root_collections_1.value }}
```

---

## Examples

### Display child collections on a collection page

Loop over `children_collections` to render a grid of subcategories:

```liquid
{% assign children = collection.metafields['app--162129281025'].children_collections.value %}

{% if children.size > 0 %}
  <ul class="subcategory-grid">
    {% for child in children %}
      <li>
        <a href="{{ child.url }}">
          {% if child.featured_image %}
            {{ child.featured_image
              | image_url: width: 600
              | image_tag: loading: 'lazy' }}
          {% endif %}
          <span>{{ child.title }}</span>
        </a>
      </li>
    {% endfor %}
  </ul>
{% endif %}
```

### Display all root collections

Merge the root batches into a single array:

```liquid
{% assign roots = shop.metafields['app--162129281025'].root_collections_1.value %}

{%- comment -%}
  If your store has more than 250 root collections, concatenate the additional batches:
  {% assign batch_2 = shop.metafields['app--162129281025'].root_collections_2.value %}
  {% assign roots = roots | concat: batch_2 %}
{%- endcomment -%}

<ul>
  {% for col in roots %}
    <li><a href="{{ col.url }}">{{ col.title }}</a></li>
  {% endfor %}
</ul>
```

### Build a collection breadcrumb

Walk up the tree using `parent_collection` to produce a trail like _Home › Women › Shoes › Sneakers_:

```liquid
{% assign crumbs = '' | split: '' %}
{% assign current = collection %}

{% for i in (1..10) %}
  {% assign crumbs = crumbs | unshift: current %}
  {% assign current = current.metafields['app--162129281025'].parent_collection.value %}
  {% if current == blank %}
    {% break %}
  {% endif %}
{% endfor %}

<nav aria-label="Breadcrumb">
  <ol>
    <li><a href="/">Home</a></li>
    {% for crumb in crumbs %}
      {% if crumb == collection %}
        <li aria-current="page">{{ crumb.title }}</li>
      {% else %}
        <li><a href="{{ crumb.url }}">{{ crumb.title }}</a></li>
      {% endif %}
    {% endfor %}
  </ol>
</nav>
```

### Pick the best breadcrumb collection for a product

Products can belong to multiple collections. Use `breadcrumb_priority` (configured in the app under **Breadcrumbs**) and `depth` to select the most relevant one:

```liquid
{% assign best_collection = nil %}
{% assign best_priority = nil %}
{% assign best_depth = nil %}

{% for col in product.collections %}
  {% assign depth = col.metafields['app--162129281025'].depth %}
  {% assign priority = col.metafields['app--162129281025'].breadcrumb_priority %}

  {% if depth >= 1 %}
    {% assign dominated = false %}

    {% comment %} Prefer lower priority value (higher importance) {% endcomment %}
    {% if priority != blank %}
      {% if best_priority == blank or priority < best_priority %}
        {% assign dominated = true %}
      {% endif %}
    {% endif %}

    {% comment %} Same priority → prefer deeper collection {% endcomment %}
    {% if priority == best_priority and depth > best_depth %}
      {% assign dominated = true %}
    {% endif %}

    {% if best_depth == blank or dominated %}
      {% assign best_priority = priority %}
      {% assign best_depth = depth %}
      {% assign best_collection = col %}
    {% endif %}
  {% endif %}
{% endfor %}

{% comment %}
  Now build the breadcrumb by walking up from best_collection
  using parent_collection — same technique as the collection breadcrumb above.
{% endcomment %}
```

### Check a collection's depth

Useful for conditional logic — for example, showing a different layout for top-level vs. deeply nested collections:

```liquid
{% assign depth = collection.metafields['app--162129281025'].depth %}

{% if depth == 1 %}
  {%- comment -%} Root collection — show large hero banner {%- endcomment -%}
{% elsif depth >= 3 %}
  {%- comment -%} Deep collection — show compact header {%- endcomment -%}
{% endif %}
```
